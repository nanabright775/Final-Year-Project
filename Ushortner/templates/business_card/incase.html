{% extends "basehome/base.html" %}
{% comment %} <script src="{% 'https://cdn.jsdelivr.net/npm/html2canvas@1.3.2/dist/html2canvas.min.js' %}" defer></script> {% endcomment %}
{% comment %} <script src="{% static 'scripts.js' %}" defer></script> {% endcomment %}

{% load static %}
{% block title %}{{ business_card.name }}'s Business Card{% endblock %}
{% block content %}

{% comment %} <div class="p-10 sm:ml-64"> 
    <div class="container mx-auto bg-white p-8 rounded-lg shadow-lg">
        <h1 class="text-3xl font-bold mb-4">{{ business_card.name }}'s Business Card</h1>
        <div id="business-card" class="flex flex-col items-center bg-gray-100 p-4 rounded-lg shadow-md" style="width: 300px;">
            <div class="h-48 overflow-hidden">
            <img src="{{ business_card.template.image.url }}" alt="Business Card Template" class="w-full h-full object-cover">
            </div>
            <div class="text-left w-full">
                <p class="text-sm"><strong>Name:</strong> {{ business_card.name }}</p>
                <p class="text-sm"><strong>Company:</strong> {{ business_card.company_name }}</p>
                <p class="text-sm"><strong>Email:</strong> {{ business_card.email }}</p>
                <p class="text-sm"><strong>Phone:</strong> {{ business_card.phone_number }}</p>
                <p class="text-sm"><strong>LinkedIn:</strong><a href="{{ business_card.linkedin }}" class="text-blue-500 hover:underline break-words">{{ business_card.linkedin }}</a></p>
                <p class="text-sm"><strong>Twitter:</strong> <a href="{{ business_card.twitter }}" class="text-blue-500 hover:underline break-words">{{ business_card.twitter }}</a></p>
                <p class="text-sm"><strong>Facebook:</strong> <a href="{{ business_card.facebook }}" class="text-blue-500 hover:underline break-words">{{ business_card.facebook }}</a></p>
                <p class="text-sm"><strong>Instagram:</strong> <a href="{{ business_card.instagram }}" class="text-blue-500 hover:underline break-words">{{ business_card.instagram }}</a></p>
            </div>
        </div>
        <div class="mt-6 flex space-x-4">
            <button id="downloadBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Download as Image</button>
            <button id="shareBtn" class="bg-green-700 text-white px-4 py-2 rounded-lg hover:bg-green-600">Share</button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.3.2/dist/html2canvas.min.js" defer></script>
<script>
    document.getElementById('downloadBtn').addEventListener('click', function() {
        const businessCard = document.getElementById('business-card');
        const buttons = document.querySelectorAll('button');
        buttons.forEach(button => button.style.display = 'none');

        html2canvas(businessCard).then(function(canvas) {
            buttons.forEach(button => button.style.display = '');
            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png');
            link.download = '{{ business_card.name }}_business_card.png';
            link.click();
        });
    });

    document.getElementById('shareBtn').addEventListener('click', function() {
        if (navigator.share) {
            navigator.share({
                title: '{{ business_card.name }}\'s Business Card',
                text: 'Check out this business card!',
                url: window.location.href
            }).catch(error => console.error('Error sharing:', error));
        } else {
            alert('Your browser does not support the Web Share API.');
        }
    });
</script>
{% endblock %} {% endcomment %}

<div class="p-10 sm:ml-64"> 
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-4">{{ business_card.name }}'s Business Card</h1>
        <div class="bg-white p-6 rounded-lg shadow-md">
            <img src="{% static business_card.image_path %}" alt="{{ business_card.name }}'s Business Card" class="w-full h-auto mb-4">
            <div class="mt-4 flex space-x-2">
                <a href="{% url 'business_card_list' %}" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600">Back to List</a>
                <a href="#" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600" id="download-card">Download</a>
                <a href="whatsapp://send?text={{ request.build_absolute_uri }}" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">Share</a>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('download-card').addEventListener('click', function() {
    var link = document.createElement('a');
    link.href = "{% static business_card.image_path %}";
    link.download = '{{ business_card.name }}_business_card.png';
    link.click();
});
</script>
{% endblock %}
